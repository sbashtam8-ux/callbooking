<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>QA / Training Platform</title>
<style>
    body {font-family: Calibri, sans-serif; background: #f3f4f6; margin:0; padding:0;}
    header {background:#0b3d91; color:white; padding:15px; display:flex; justify-content:space-between; align-items:center;}
    header h1 {margin:0; font-size:28px;}
    nav a {margin-left:15px; text-decoration:none; color:white; font-weight:bold; padding:5px 10px; border-radius:5px;}
    nav a.active, nav a:hover {background:#0f7c5c;}
    .container {padding:20px;}
    .card {background:white; padding:20px; margin-bottom:20px; border-radius:12px; box-shadow: 0 8px 20px rgba(0,0,0,0.1);}
    input, select, textarea, button {padding:10px; margin-top:5px; width:100%; border-radius:6px; border:1px solid #ccc; box-sizing:border-box;}
    button {background:#0f7c5c; color:white; border:none; cursor:pointer; font-weight:bold;}
    button:hover {background:#0b5d45;}
    table {width:100%; border-collapse: collapse;}
    th, td {border:1px solid #ddd; padding:10px; text-align:center;}
    th {background:#0b3d91; color:white;}
    .hidden {display:none;}
    .chart-container {display:flex; gap:20px; flex-wrap:wrap;}
    .chart-card {flex:1; min-width:200px; padding:20px; border-radius:12px; background:white; box-shadow: 0 8px 20px rgba(0,0,0,0.1);}
</style>
</head>
<body>

<header>
    <h1>QA / Training Platform</h1>
    <nav>
        <a href="#" class="nav-link active" data-page="home">خانه</a>
        <a href="#" class="nav-link" data-page="trainer">مربیان</a>
        <a href="#" class="nav-link" data-page="coordination">Coordination</a>
        <a href="#" class="nav-link" data-page="dashboard">داشبورد مدیریتی</a>
    </nav>
</header>

<div class="container">
    <!-- صفحه ورود -->
    <div id="loginPage" class="card">
        <h2>ورود به سیستم</h2>
        <input type="text" id="username" placeholder="نام کاربری">
        <input type="password" id="password" placeholder="رمز عبور">
        <button onclick="login()">ورود</button>
    </div>

    <!-- صفحه Home -->
    <div id="home" class="card hidden">
        <h2>صفحه اصلی</h2>
        <p>این پلتفرم حرفه‌ای برای مدیریت تیم آموزش، ثبت و پیگیری دوره‌های آموزشی مربیان و هماهنگی کارشناسان طراحی شده است. تمامی فرایندهای آموزش از این پس توسط مربیان در این پنل ثبت می‌شود و مدیران می‌توانند وضعیت هر دوره را تایید یا رد کنند. این سامانه با فرم‌های شیک و کارت‌های تعاملی، به مدیران امکان می‌دهد روند پیشرفت آموزش‌ها را به صورت نموداری و دقیق مشاهده کنند.</p>
    </div>

    <!-- صفحه مربیان -->
    <div id="trainer" class="card hidden">
        <h2>ثبت فرم مربی</h2>
        <input type="text" id="trainerName" placeholder="نام و نام خانوادگی">
        <select id="trainingTitle">
            <option value="آموزش دوره اول">آموزش دوره اول</option>
            <option value="آموزش دوره دوم">آموزش دوره دوم</option>
            <option value="آموزش دوره‌ای">آموزش دوره‌ای</option>
            <option value="آموزش همراهی">آموزش همراهی</option>
        </select>
        <textarea id="trainingDesc" placeholder="توضیحات اختیاری"></textarea>
        <input type="number" id="newJoiners" placeholder="تعداد نیوجوینرها">
        <button onclick="submitTrainerForm()">ثبت فرم</button>
        <h3>لیست مربیان ثبت شده</h3>
        <table id="trainerTable">
            <thead><tr><th>نام مربی</th><th>عنوان آموزشی</th><th>توضیحات</th><th>نیوجوینرها</th><th>حذف</th></tr></thead>
            <tbody></tbody>
        </table>
    </div>

    <!-- صفحه Coordination -->
    <div id="coordination" class="card hidden">
        <h2>ثبت فرم Coordination</h2>
        <input type="text" id="coordName" placeholder="نام و نام خانوادگی کوردیناتور">
        <input type="text" id="expertName" placeholder="نام و نام خانوادگی کارشناس">
        <input type="date" id="coordDate" placeholder="تاریخ ثبت درخواست">
        <input type="number" id="courseMembers" placeholder="تعداد اعضای دوره">
        <button onclick="submitCoordForm()">ثبت فرم</button>
        <h3>لیست Coordination ثبت شده</h3>
        <table id="coordTable">
            <thead><tr><th>کوردیناتور</th><th>کارشناس</th><th>تاریخ</th><th>اعضا</th><th>وضعیت</th><th>حذف</th><th>عملیات مدیر</th></tr></thead>
            <tbody></tbody>
        </table>
    </div>

    <!-- صفحه داشبورد -->
    <div id="dashboard" class="card hidden">
        <h2>داشبورد مدیریتی</h2>
        <div class="chart-container">
            <div class="chart-card" id="chart1"><h4>آموزش دوره اول</h4><div id="chart1Content"></div></div>
            <div class="chart-card" id="chart2"><h4>آموزش دوره دوم</h4><div id="chart2Content"></div></div>
            <div class="chart-card" id="chart3"><h4>آموزش دوره‌ای</h4><div id="chart3Content"></div></div>
            <div class="chart-card" id="chart4"><h4>آموزش همراهی</h4><div id="chart4Content"></div></div>
        </div>
    </div>
</div>

<script>
let trainerData = [];
let coordData = [];
let currentUserRole = "";

// --- Login ---
function login(){
    const user=document.getElementById('username').value.trim();
    const pass=document.getElementById('password').value.trim();
    if(user==="manager" && pass==="snapp123"){
        currentUserRole="manager";
        showPage("home");
    } else if(user==="trainer" && pass==="trainer"){
        currentUserRole="trainer";
        showPage("home");
    } else { alert("نام کاربری یا رمز اشتباه است!"); return; }
    document.getElementById('loginPage').classList.add('hidden');
}

// --- Navigation ---
const links=document.querySelectorAll('.nav-link');
links.forEach(link=>{
    link.addEventListener('click',e=>{
        e.preventDefault();
        showPage(link.dataset.page);
        links.forEach(l=>l.classList.remove('active'));
        link.classList.add('active');
    });
});

function showPage(page){
    ['home','trainer','coordination','dashboard'].forEach(p=>{
        document.getElementById(p).classList.add('hidden');
    });
    document.getElementById(page).classList.remove('hidden');
    updateCharts();
}

// --- LocalStorage ---
function saveData(){
    localStorage.setItem('trainerData', JSON.stringify(trainerData));
    localStorage.setItem('coordData', JSON.stringify(coordData));
}

function loadData(){
    trainerData=JSON.parse(localStorage.getItem('trainerData')||'[]');
    coordData=JSON.parse(localStorage.getItem('coordData')||'[]');
    updateTrainerTable();
    updateCoordTable();
    updateCharts();
}

// --- Trainer Form ---
function submitTrainerForm(){
    let name=document.getElementById('trainerName').value;
    let title=document.getElementById('trainingTitle').value;
    let desc=document.getElementById('trainingDesc').value;
    let nj=document.getElementById('newJoiners').value;
    trainerData.push({name,title,desc,nj});
    saveData();
    updateTrainerTable();
    updateCharts();
    alert("فرم مربی ثبت شد!");
}

function updateTrainerTable(){
    const tbody=document.querySelector("#trainerTable tbody");
    tbody.innerHTML="";
    trainerData.forEach((t,i)=>{
        tbody.innerHTML+=`<tr>
        <td>${t.name}</td>
        <td>${t.title}</td>
        <td>${t.desc}</td>
        <td>${t.nj}</td>
        <td><button onclick="deleteTrainer(${i})">حذف</button></td>
        </tr>`;
    });
}

function deleteTrainer(idx){
    if(confirm("آیا مطمئن هستید میخواید این فرم را حذف کنید؟")){
        trainerData.splice(idx,1);
        saveData();
        updateTrainerTable();
        updateCharts();
    }
}

// --- Coordination Form ---
function submitCoordForm(){
    let coordName=document.getElementById('coordName').value;
    let expertName=document.getElementById('expertName').value;
    let date=document.getElementById('coordDate').value;
    let members=document.getElementById('courseMembers').value;
    coordData.push({coordName,expertName,date,members,status:"در انتظار"});
    saveData();
    updateCoordTable();
    updateCharts();
    alert("فرم Coordination ثبت شد!");
}

function updateCoordTable(){
    const tbody=document.querySelector("#coordTable tbody");
    tbody.innerHTML="";
    coordData.forEach((c,i)=>{
        let ops="";
        if(currentUserRole==="manager"){
            ops=`<button onclick="approveCoord(${i})">تایید</button>
            <button onclick="rejectCoord(${i})">رد</button>`;
        }
        let delBtn=currentUserRole==="manager" || currentUserRole==="trainer"?`<button onclick="coordDelete(${i})">حذف</button>`:"";
        tbody.innerHTML+=`<tr>
        <td>${c.coordName}</td>
        <td>${c.expertName}</td>
        <td>${c.date}</td>
        <td>${c.members}</td>
        <td>${c.status}</td>
        <td>${delBtn}</td>
        <td>${ops}</td>
        </tr>`;
    });
}

function coordDelete(idx){
    if(confirm("آیا مطمئن هستید میخواید این فرم را حذف کنید؟")){
        coordData.splice(idx,1);
        saveData();
        updateCoordTable();
        updateCharts();
    }
}

function approveCoord(idx){ coordData[idx].status="تایید شد"; saveData(); updateCoordTable(); }
function rejectCoord(idx){ coordData[idx].status="رد شد"; saveData(); updateCoordTable(); }

// --- Charts ---
function updateCharts(){
    const chartData=[0,0,0,0]; // دوره اول، دوم، دوره‌ای، همراهی
    trainerData.forEach(t=>{
        if(t.title==="آموزش دوره اول") chartData[0]+=parseInt(t.nj||0);
        else if(t.title==="آموزش دوره دوم") chartData[1]+=parseInt(t.nj||0);
        else if(t.title==="آموزش دوره‌ای") chartData[2]+=parseInt(t.nj||0);
        else if(t.title==="آموزش همراهی") chartData[3]+=parseInt(t.nj||0);
    });
    document.getElementById("chart1Content").innerText=`تعداد ثبت شده: ${chartData[0]}`;
    document.getElementById("chart2Content").innerText=`تعداد ثبت شده: ${chartData[1]}`;
    document.getElementById("chart3Content").innerText=`تعداد ثبت شده: ${chartData[2]}`;
    document.getElementById("chart4Content").innerText=`تعداد ثبت شده: ${chartData[3]}`;
}

// --- Initialize ---
window.onload=loadData;
</script>

</body>
</html>
